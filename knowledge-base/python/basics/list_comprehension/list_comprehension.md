---
title: "List Comprehensions (Списковые включения)"
difficulty: medium
tags: ["syntax", "lists", "loops", "pythonic"]
added: "2026-02-19"
last_reviewed: null
---

## Что это такое

**List Comprehension** (списковое включение или списочное выражение) — это компактный и читаемый способ создания списков в Python. Он позволяет заменить многострочные циклы `for` для генерации списков одной строкой.

Это считается "питоничным" (Pythonic) подходом, так как он часто более производителен и выразителен, чем использование стандартных циклов и метода `.append()`.

## Ключевые концепции

### 1. Базовый синтаксис

Классический цикл `for`:
```python
squares = []
for i in range(5):
    squares.append(i * i)
# [0, 1, 4, 9, 16]
```

Эквивалент с помощью list comprehension:
```python
squares = [i * i for i in range(5)]
# [0, 1, 4, 9, 16]
```

Формула: `[выражение for элемент in итерируемый_объект]`

### 2. Добавление условия

Можно добавить условие `if` для фильтрации элементов.

Классический цикл `for` с `if`:
```python
even_squares = []
for i in range(10):
    if i % 2 == 0:
        even_squares.append(i * i)
# [0, 4, 16, 36, 64]
```

Эквивалент с list comprehension:
```python
even_squares = [i * i for i in range(10) if i % 2 == 0]
# [0, 4, 16, 36, 64]
```

Формула: `[выражение for элемент in итерируемый_объект if условие]`

### 3. Использование `if-else` (тернарный оператор)

Если нужно изменять сам элемент в зависимости от условия, используется тернарный оператор `... if ... else ...`, который ставится **перед** циклом `for`.

```python
# Заменить нечётные числа на 'odd'
result = [i if i % 2 == 0 else "odd" for i in range(5)]
# [0, 'odd', 2, 'odd', 4]
```

Формула: `[выражение_if_true if условие else выражение_if_false for элемент in итерируемый_объект]`

## Частые ошибки

1.  **Излишняя сложность.** Попытка вложить слишком много логики в одно выражение делает его нечитаемым. Если list comprehension занимает больше 2-3 строк, лучше использовать обычный цикл `for`.
2.  **Путаница с синтаксисом `if` и `if-else`**.
    *   Фильтрующий `if` всегда идёт **в конце**.
    *   Изменяющий `if-else` (тернарный оператор) всегда идёт **в начале**, до `for`.
3.  **Использование для сложных побочных эффектов.** List comprehensions предназначены для создания списков, а не для выполнения операций, которые что-то меняют вне списка (например, запись в файл, изменение глобальных переменных).

## Вопросы для самопроверки
- Что такое list comprehension и в чем его преимущество перед обычным циклом for?
- Как добавить фильтрующее условие `if` в list comprehension? Где оно должно располагаться?
- Как использовать конструкцию `if-else` внутри list comprehension и где она пишется?
- В каких случаях лучше использовать обычный цикл `for` вместо list comprehension?
- Перепишите следующий код, используя list comprehension: `new_list = []; for word in words: new_list.append(word.upper())`
- Можно ли использовать вложенные циклы в list comprehension? Если да, приведите пример.
